<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

<meta name="Description" content="Information architecture, Web Design, Web Standards." />
<meta name="Keywords" content="falcon, programming" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="Ablaze.css" type="text/css" media="screen" />

<title>Iterators</title>
	
</head>

<body>

	<!-- header starts here -->
	<div id="header"><div id="header-content">	
		
		<h1 id="logo">Iterators</h1>	
		<h2 id="slogan">lets you get started with Falcon</h2>			
	
	</div></div>
				
	<!-- content-wrap starts here -->
	<div id="content-wrap"><div id="content">	 
	
		<div id="sidebar" >				
			<div class="sidebox">
			<h1>Navigation:</h1>
			<ol>
<li><a href="Falcon's%20Survival%20Guide.html">Falcon's Survival Guide</a></li>
<li><a href="Introduction.html">Introduction</a></li>
<li><a href="Control%20structures.html">Control structures</a></li>
<li><a href="Basic%20Datatypes.html">Basic Datatypes</a></li>
<li><a href="The%20functions.html">The functions</a></li>
<li><a href="Functional%20programming.html">Functional programming</a></li>
<li><a href="Objects%20and%20classes.html">Objects and classes</a></li>
<li><a href="Prototype%20based%20OOP.html">Prototype based OOP</a></li>
<li><a href="Message%20Oriented%20Programming.html">Message Oriented Programming</a></li>
<li><a href="Tabular%20programming.html">Tabular programming</a></li>
<li><a href="Iterators.html">Iterators</a></li>
<li><a href="ListComprehension.html">ListComprehension</a></li>
<li><a href="Error%20recovery.html">Error recovery</a></li>
<li><a href="Falcon%20modules.html">Falcon modules</a></li>
<li><a href="The%20directive%20statement.html">The directive statement</a></li>
<li><a href="Advanced%20topics.html">Advanced topics</a></li>
</ol>

			</div>
			
			<div class="sidebox">
			<h1>Table of contents:</h1>
			<ul>
<li><a href="#Iterators">Iterators</a></li>
</ul>

			</div>
					
			<div class="sidebox">
				<h1>Wise Words</h1>
			
				<p>&quot;Falcon provides six integrated programming paradigms: procedural, object oriented, prototype oriented, functional, tabular and message oriented. And you don't have to master all of them; you just need to pick the ingredients you prefer, and let the code to follow your inspiration&quot;</p>		
		
			</div>	
	
				
		</div>	
	
		<div id="main">		
<!-- Generated by Falcon Markup Engine -->
<center class="navi">Previous: <a class="navi" href="Tabular programming.html">Tabular programming</a>   -- Top: <a class="navi" href="Falcon's Survival Guide.html">Falcon's Survival Guide</a>   -- Next: <a class="navi" href="ListComprehension.html">ListComprehension</a>
</center>
<h1><a name="Iterators">Iterators</a></h1>

<p>Iterators are objects meant to access sequentially other structures. They are the preferred way to partially scan a long sequence of data. They provide all the functionalities of a for-in loop and they operate on the same structures that the for/in loop manages, but they can also be used to scan a sequence backwards, insert data at a certain position or record one or more positions for further usage.</p>

<p>Iterators can get invalidated because of operations on the underlying sequence, or because they are moved outside the sequence range. The rules for invalidation varies depending on the underlying structure, but usually adding or removing an element may cause invalidation. The only safe way to change a structure so that the iterators stay valid is doing that through the iterators themselves. </p>

<p>An iterator is created calling the <tt>first()</tt> or <tt>last()</tt> method on sequences, or using the constructor of the <tt>Iterator</tt> class. For example :</p>

<pre>
iter <span class="falOperators">=</span> Iterator<span class="falPars">(</span> <span class="falPars">[</span> first<span class="falPars">,</span> second<span class="falPars">,</span> third <span class="falPars">]</span> <span class="falPars">)</span> 
vector <span class="falOperators">=</span> <span class="falPars">[</span> <span class="falDoubleString">"</span><span class="falDoubleString">a</span><span class="falDoubleString">"</span><span class="falPars">,</span><span class="falDoubleString">"</span><span class="falDoubleString">b</span><span class="falDoubleString">"</span><span class="falPars">,</span><span class="falDoubleString">"</span><span class="falDoubleString">c</span><span class="falDoubleString">"</span> <span class="falPars">]</span><span class="falPars">;</span>  iter <span class="falOperators">=</span> vector<span class="Integer">.</span>first<span class="falPars">(</span><span class="falPars">)</span>
iter <span class="falOperators">=</span> vector<span class="Integer">.</span>last<span class="falPars">(</span><span class="falPars">)</span> </pre>

<p>Are all valid ways to create an iterator on an array. In case of random access sequences (the items you can access using an integer index in square brackets), the Iterator class constructor may be given an optional numeric parameter indicating the initial position where the iterator is placed. The integer accepts array convention where a negative number indicates a position from the end of the sequence. Iterators for other sequences accepts only 0 or -1 (for the last element). Iterators over attributes (which scans the objects that have been currently assigned a certain attribute) can be created only starting from the begin of the sequence. </p>

<p>Iterators provide the <tt>value()</tt> to read or set the current value. Using it on an invalid iterator raises an access error; the <tt>hasCurrent()</tt> method returns true if the iterator is valid, so it can be used to check if the iterator has been moved outside the sequence.</p>

<p>The <tt>next()</tt> and <tt>prev()</tt> methods move the iterator respectively forward and backward in the sequence. They return true if there is a next or previous element, and false if the operation caused the iterator to move outside the bounds of the sequence, making it invalid. Since when that happens it is often too late, <tt>hasNext()</tt> and <tt>hasPrev()</tt> methods are also provided to allow last element special processing. An element that doesn't have a next element is the last element of a sequence, and if it has no previous element it is the first.</p>

<p>So, we can rewrite a common have a nice day! for/in loop like the following: </p>

<pre>
list <span class="falOperators">=</span> List<span class="falPars">(</span> <span class="falDoubleString">"</span><span class="falDoubleString">have</span><span class="falDoubleString">"</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">a</span><span class="falDoubleString">"</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">nice</span><span class="falDoubleString">"</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">day</span><span class="falDoubleString">"</span> <span class="falPars">)</span> 
iter <span class="falOperators">=</span> list<span class="Integer">.</span>first<span class="falPars">(</span><span class="falPars">)</span> 
 
<span class="falKeywords">while</span> iter<span class="Integer">.</span>hasCurrent<span class="falPars">(</span><span class="falPars">)</span>
   <span class="falOperators">&gt;</span><span class="falOperators">&gt;</span> iter<span class="Integer">.</span>value<span class="falPars">(</span><span class="falPars">)</span>
    <span class="falKeywords">if</span> iter<span class="Integer">.</span>hasNext<span class="falPars">(</span><span class="falPars">)</span>
      <span class="falOperators">&gt;</span><span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString"> </span><span class="falDoubleString">"</span>
    <span class="falKeywords">else</span> 
      <span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString">!</span><span class="falDoubleString">"</span>
    <span class="falKeywords">end</span> 
 
   iter<span class="Integer">.</span>next<span class="falPars">(</span><span class="falPars">)</span>  <span class="falComment">// still works if hasNext() is false</span>
<span class="falKeywords">end</span> </pre>

<p>For dictionaries, the <tt>key()</tt> method retrieves the current element key. For example , the following loop we change every item in the dictionary if the key starts with c.</p>

<pre>
dict <span class="falOperators">=</span> <span class="falPars">[</span> <span class="falDoubleString">"</span><span class="falDoubleString">alpha</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">1</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">beta</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString">2</span><span class="falDoubleString">"</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">charlie</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">3</span><span class="falPars">,</span> 
         <span class="falDoubleString">"</span><span class="falDoubleString">carl</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">4</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">day</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span><span class="Integer">5</span> <span class="falPars">]</span>
iter <span class="falOperators">=</span> dict<span class="Integer">.</span>first<span class="falPars">(</span><span class="falPars">)</span> 
 
 <span class="falKeywords">while</span> iter<span class="Integer">.</span>hasNext<span class="falPars">(</span><span class="falPars">)</span>
    <span class="falKeywords">if</span> iter<span class="Integer">.</span>key<span class="falPars">(</span><span class="falPars">)</span><span class="falPars">[</span><span class="Integer">0</span><span class="falPars">]</span> <span class="falOperators">=</span><span class="falOperators">=</span> <span class="falDoubleString">"</span><span class="falDoubleString">c</span><span class="falDoubleString">"</span>
      iter<span class="Integer">.</span>value<span class="falPars">(</span> <span class="falDoubleString">"</span><span class="falDoubleString">Changed</span><span class="falDoubleString">"</span> <span class="falPars">)</span>
    <span class="falKeywords">end</span> 
    iter<span class="Integer">.</span>next<span class="falPars">(</span><span class="falPars">)</span> 
<span class="falKeywords">end</span> 
 
<span class="falKeywords">inspect</span><span class="falPars">(</span> dict <span class="falPars">)</span> </pre>

<p>It is possible to partially scan a dictionary, which is ordered by key, using the dictBest() function. It returns an iterator to the item considered lexicographically equal or immediately greater than the searched key. The above example can be rewritten using dictBest like this:</p>

<pre>
dict <span class="falOperators">=</span> <span class="falPars">[</span> <span class="falDoubleString">"</span><span class="falDoubleString">alpha</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">1</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">beta</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString">2</span><span class="falDoubleString">"</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">charlie</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">3</span><span class="falPars">,</span> 
         <span class="falDoubleString">"</span><span class="falDoubleString">carl</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">4</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">day</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span><span class="Integer">5</span> <span class="falPars">]</span>
iter <span class="falOperators">=</span> dictBest<span class="falPars">(</span> dict<span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">c</span><span class="falDoubleString">"</span> <span class="falPars">)</span> 
 
<span class="falKeywords">while</span> iter<span class="Integer">.</span>hasNext<span class="falPars">(</span><span class="falPars">)</span> <span class="falLogic">and</span> iter<span class="Integer">.</span>key<span class="falPars">(</span><span class="falPars">)</span><span class="falPars">[</span><span class="Integer">0</span><span class="falPars">]</span> <span class="falOperators">=</span> <span class="falDoubleString">"</span><span class="falDoubleString">c</span><span class="falDoubleString">"</span>
   iter<span class="Integer">.</span>value<span class="falPars">(</span> <span class="falDoubleString">"</span><span class="falDoubleString">Changed</span><span class="falDoubleString">"</span> <span class="falPars">)</span>
   iter<span class="Integer">.</span>next<span class="falPars">(</span><span class="falPars">)</span>
<span class="falKeywords">end</span> 
 
<span class="falKeywords">inspect</span><span class="falPars">(</span> dict <span class="falPars">)</span> </pre>

<p>Iterators can be compared for equality; iterators are equal when they point to the same item in the same collection. For example , this loop would work too:</p>

<pre>
list <span class="falOperators">=</span> List<span class="falPars">(</span> <span class="Integer">1</span><span class="falPars">,</span> <span class="Integer">2</span><span class="falPars">,</span> <span class="Integer">3</span><span class="falPars">,</span> <span class="Integer">4</span><span class="falPars">,</span> <span class="Integer">5</span><span class="falPars">,</span> <span class="Integer">6</span><span class="falPars">,</span> <span class="Integer">7</span> <span class="falPars">)</span> 
iter <span class="falOperators">=</span> list<span class="Integer">.</span>first<span class="falPars">(</span><span class="falPars">)</span> 
lastIter <span class="falOperators">=</span> list<span class="Integer">.</span>last<span class="falPars">(</span><span class="falPars">)</span> 
 
<span class="falKeywords">loop</span> 
   <span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString">Element: </span><span class="falDoubleString">"</span><span class="falPars">,</span> iter<span class="Integer">.</span>value<span class="falPars">(</span><span class="falPars">)</span>
   <span class="falKeywords">if</span> iter <span class="falOperators">=</span><span class="falOperators">=</span> lastIter<span class="falOperators">:</span> <span class="falKeywords">break</span>
   iter<span class="Integer">.</span>next<span class="falPars">(</span><span class="falPars">)</span>
<span class="falKeywords">end</span> 
 
<span class="falKeywords">inspect</span><span class="falPars">(</span> iter <span class="falPars">)</span> </pre>

<p>Iterators can be used to remove or insert an item in a collection. In the case of dictionaries, both the key and the value must be provided; if the iterator is already pointing to a position which is lexicographically correct for the given item, then the dictionary is not scanned for a correct position before insertion. Compare the following code:</p>

<pre>
dict <span class="falOperators">=</span> <span class="falPars">[</span> <span class="falDoubleString">"</span><span class="falDoubleString">alpha</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">1</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">beta</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">2</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">charlie</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString">3</span><span class="falDoubleString">"</span> <span class="falPars">]</span> 
 <span class="falKeywords">if</span> <span class="falDoubleString">"</span><span class="falDoubleString">beta</span><span class="falDoubleString">"</span> <span class="falLogic">in</span> dict
   dict<span class="falPars">[</span> <span class="falDoubleString">"</span><span class="falDoubleString">bravo</span><span class="falDoubleString">"</span> <span class="falPars">]</span> <span class="falOperators">=</span> <span class="Integer">4</span>
<span class="falKeywords">end</span> </pre>

<p>With this: </p>

<pre>
dict <span class="falOperators">=</span> <span class="falPars">[</span> <span class="falDoubleString">"</span><span class="falDoubleString">alpha</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">1</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">beta</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="Integer">2</span><span class="falPars">,</span> <span class="falDoubleString">"</span><span class="falDoubleString">charlie</span><span class="falDoubleString">"</span> <span class="falOperators">=</span><span class="falOperators">&gt;</span> <span class="falDoubleString">"</span><span class="falDoubleString">3</span><span class="falDoubleString">"</span> <span class="falPars">]</span> 
iBest <span class="falOperators">=</span> dictFind<span class="falPars">(</span> <span class="falDoubleString">"</span><span class="falDoubleString">beta</span><span class="falDoubleString">"</span> <span class="falPars">)</span> 
 <span class="falKeywords">if</span> iBest
   iBest<span class="Integer">.</span>next<span class="falPars">(</span><span class="falPars">)</span>
   iBest<span class="Integer">.</span>insert<span class="falPars">(</span> <span class="falDoubleString">"</span><span class="falDoubleString">bravo</span><span class="falDoubleString">"</span><span class="falPars">,</span> <span class="Integer">4</span> <span class="falPars">)</span>
<span class="falKeywords">end</span> </pre>

<p>In the first case, two scans have to be performed on the dictionary; the first to search for the value, the second to insert. In the second case, Falcon will use the information in the iBest iterator to avoid the second scan. However, notice that creating an iterator is a relatively heavy operation, and usually a single dictionary search is faster, so this technique is better exploited with repeated insertions. </p>

<center class="navi">Previous: <a class="navi" href="Tabular programming.html">Tabular programming</a>   -- Top: <a class="navi" href="Falcon's Survival Guide.html">Falcon's Survival Guide</a>   -- Next: <a class="navi" href="ListComprehension.html">ListComprehension</a>
</center>
<!-- END of document generated by Falcon Markup Engine -->
		</div>			
		
	
	<!-- content-wrap ends here -->		
	</div></div>

	<!-- footer starts here -->	
	<div id="footer"><div id="footer-content">
	
		<div class="col float-left">
			<h2>Site Partners</h2>
			<ul>				
				<li><a href="http://falconpl.org"><strong>Falcon</strong> - The programming langage</a></li>
				<li><a href="http://falconpl.org/index.ftd?page_id=manuals"><strong>Falcon manuals</strong> - If you want to go further</a></li>
			</ul>			
		</div>
		
		<div class="col float-left">
			<h2>Links</h2>
			<ul>				
				<li><a href="http://www.openwebdesign.org/"><strong>openwebdesign.org</strong></a></li>
				<li><a href="http://www.OSWD.org/"><strong>OSWD.org</strong></a></li>
				<li><a href="http://www.zeroweb.org/"><strong>zeroweb.org</strong></a></li>
				<li><a href="http://www.alistapart.com/"><strong>Alistapart</strong></a></li>		
				<li><a href="http://www.cssremix.com/"><strong>CSS Remix</strong></a></li>					
			</ul>			
		</div>		
	
		<div class="col2 float-right">
			<p>
			&copy; copyright 2009 <strong>Jonnymind</strong><br /> 
			Design by: <a href="index.html"><strong>styleshout</strong></a> &nbsp; &nbsp;
			Valid <a href="http://jigsaw.w3.org/css-validator/check/referer"><strong>CSS</strong></a> | 
		   	   <a href="http://validator.w3.org/check/referer"><strong>XHTML</strong></a>
		   <br />
		   Contents of this guide is generated by Falcon's wikiparser and highlighter modules &copy; Kib².
			</p>
		

		</div>
	
	</div></div>
	<!-- footer ends here -->

</body>
</html>